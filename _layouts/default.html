<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% if page.title %}{{ page.title }} - {% endif %}{{ site.title }}</title>
    <meta name="description" content="{{ page.description | default: site.description }}">
    
    <!-- SEO tags -->
    {% seo %}
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="{{ '/assets/images/favicon.svg' | relative_url }}">
    <link rel="icon" type="image/png" href="{{ '/assets/images/favicon.png' | relative_url }}">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@300;400;500&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="{{ '/assets/css/main.css' | relative_url }}">
    
    <!-- Search -->
    <script src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script>
    
    <!-- Bookmark functionality -->
    <script>
        // Initialize bookmarks from localStorage
        window.bookmarks = JSON.parse(localStorage.getItem('solana-mcp-bookmarks') || '[]');
    </script>
</head>
<body class="eink-theme">
    <!-- Skip to main content for accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <!-- Header -->
    <header class="site-header">
        <div class="container">
            <div class="header-content">
                <div class="site-logo">
                    <a href="{{ '/' | relative_url }}" class="logo-link">
                        <img src="{{ '/assets/images/logo.svg' | relative_url }}" alt="{{ site.title }}" class="logo-image">
                        <span class="site-title">{{ site.title }}</span>
                    </a>
                </div>
                
                <!-- Navigation -->
                <nav class="main-nav" role="navigation" aria-label="Main navigation">
                    <ul class="nav-list">
                        {% for link in site.nav_links %}
                        <li class="nav-item">
                            <a href="{{ link.url | relative_url }}" 
                               class="nav-link {% if page.url == link.url %}active{% endif %}"
                               {% if link.url contains 'http' %}target="_blank" rel="noopener noreferrer"{% endif %}>
                                {{ link.title }}
                            </a>
                        </li>
                        {% endfor %}
                    </ul>
                </nav>
                
                <!-- Search and utilities -->
                <div class="header-utilities">
                    <button class="search-toggle" id="search-toggle" aria-label="Toggle search" aria-expanded="false">
                        <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="m21 21-4.35-4.35"></path>
                        </svg>
                    </button>
                    
                    <button class="bookmark-toggle" id="bookmark-toggle" aria-label="Bookmark this page" 
                            data-url="{{ page.url }}" data-title="{{ page.title | default: site.title }}">
                        <svg class="bookmark-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z"></path>
                        </svg>
                    </button>
                    
                    <button class="menu-toggle" id="menu-toggle" aria-label="Toggle menu" aria-expanded="false">
                        <span class="menu-bar"></span>
                        <span class="menu-bar"></span>
                        <span class="menu-bar"></span>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Search overlay -->
        <div class="search-overlay" id="search-overlay">
            <div class="search-container">
                <div class="search-input-wrapper">
                    <input type="text" id="search-input" placeholder="Search documentation..." autocomplete="off">
                    <button class="search-close" id="search-close" aria-label="Close search">×</button>
                </div>
                <div class="search-results" id="search-results"></div>
            </div>
        </div>
    </header>
    
    <!-- Main content -->
    <main id="main-content" class="main-content">
        <div class="container">
            {% if page.layout == 'home' %}
                {{ content }}
            {% else %}
            <div class="content-layout">
                <!-- Sidebar navigation for documentation pages -->
                {% if page.layout == 'docs' or page.collection == 'docs' %}
                <aside class="sidebar" role="complementary">
                    <nav class="docs-nav" aria-label="Documentation navigation">
                        <h3 class="docs-nav-title">Documentation</h3>
                        <ul class="docs-nav-list">
                            {% for category in site.categories %}
                            <li class="docs-nav-category">
                                <h4 class="category-title">{{ category[1].icon }} {{ category[1].title }}</h4>
                                <p class="category-description">{{ category[1].description }}</p>
                            </li>
                            {% endfor %}
                            
                            {% assign docs = site.docs | sort: 'order' %}
                            {% for doc in docs %}
                            <li class="docs-nav-item">
                                <a href="{{ doc.url | relative_url }}" 
                                   class="docs-nav-link {% if page.url == doc.url %}active{% endif %}">
                                    {{ doc.title | default: doc.name | replace: '.md', '' | replace: '_', ' ' | capitalize }}
                                </a>
                            </li>
                            {% endfor %}
                        </ul>
                    </nav>
                </aside>
                {% endif %}
                
                <!-- Page content -->
                <div class="page-content">
                    {% if page.title %}
                    <header class="page-header">
                        <div class="page-title-wrapper">
                            <h1 class="page-title">{{ page.title }}</h1>
                            <!-- GitHub source button -->
                            {% if page.collection == 'docs' %}
                                {% assign source_path = page.relative_path | default: page.path %}
                                {% if source_path %}
                                <a href="{{ site.github.repository_url }}/blob/main/{{ source_path }}" 
                                   class="github-source-btn" 
                                   target="_blank" 
                                   rel="noopener noreferrer"
                                   aria-label="View source on GitHub">
                                    <svg class="github-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
                                    </svg>
                                    <span>View source</span>
                                </a>
                                {% endif %}
                            {% elsif page.path %}
                                <a href="{{ site.github.repository_url }}/blob/main/{{ page.path }}" 
                                   class="github-source-btn" 
                                   target="_blank" 
                                   rel="noopener noreferrer"
                                   aria-label="View source on GitHub">
                                    <svg class="github-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
                                    </svg>
                                    <span>View source</span>
                                </a>
                            {% endif %}
                        </div>
                        {% if page.description %}
                        <p class="page-description">{{ page.description }}</p>
                        {% endif %}
                    </header>
                    {% endif %}
                    
                    <div class="content">
                        {{ content }}
                    </div>
                    
                    <!-- Page navigation -->
                    {% if page.collection == 'docs' %}
                    <nav class="page-nav" aria-label="Page navigation">
                        {% assign docs = site.docs | sort: 'order' %}
                        {% for doc in docs %}
                            {% if doc.url == page.url %}
                                {% assign current_index = forloop.index0 %}
                                {% break %}
                            {% endif %}
                        {% endfor %}
                        
                        {% if current_index > 0 %}
                            {% assign prev_index = current_index | minus: 1 %}
                            {% assign prev_doc = docs[prev_index] %}
                            <a href="{{ prev_doc.url | relative_url }}" class="page-nav-link prev">
                                <span class="nav-direction">← Previous</span>
                                <span class="nav-title">{{ prev_doc.title | default: prev_doc.name | replace: '.md', '' }}</span>
                            </a>
                        {% endif %}
                        
                        {% assign next_index = current_index | plus: 1 %}
                        {% if next_index < docs.size %}
                            {% assign next_doc = docs[next_index] %}
                            <a href="{{ next_doc.url | relative_url }}" class="page-nav-link next">
                                <span class="nav-direction">Next →</span>
                                <span class="nav-title">{{ next_doc.title | default: next_doc.name | replace: '.md', '' }}</span>
                            </a>
                        {% endif %}
                    </nav>
                    {% endif %}
                </div>
            </div>
            {% endif %}
        </div>
    </main>
    
    <!-- Footer -->
    <footer class="site-footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-info">
                    <p>&copy; {{ 'now' | date: '%Y' }} {{ site.author }}. Licensed under MIT.</p>
                    <p>
                        <a href="{{ site.github.repository_url }}" target="_blank" rel="noopener noreferrer">
                            View on GitHub
                        </a>
                    </p>
                </div>
                
                <div class="footer-links">
                    <a href="{{ '/search' | relative_url }}">Search</a>
                    <a href="{{ '/bookmarks' | relative_url }}">Bookmarks</a>
                    <a href="{{ site.github.repository_url }}/issues" target="_blank" rel="noopener noreferrer">Report Issue</a>
                </div>
            </div>
        </div>
    </footer>
    
    <!-- Floating LLMs.txt Button -->
    <button class="llms-floating-btn" id="llms-floating-btn" aria-label="Copy LLMs.txt content" title="Copy LLMs.txt content to clipboard">
        <svg class="llms-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
        </svg>
        <span class="llms-text">LLMs.txt</span>
    </button>
    
    <!-- Mermaid diagrams -->
    <script src="{{ '/assets/js/mermaid.min.js' | relative_url }}"></script>
    <script>
        // Convert code blocks with language-mermaid to mermaid divs
        document.addEventListener('DOMContentLoaded', function() {
            const mermaidBlocks = document.querySelectorAll('code.language-mermaid');
            mermaidBlocks.forEach(function(block) {
                const pre = block.parentNode;
                const wrapper = pre.parentNode;
                
                // Create new mermaid div
                const mermaidDiv = document.createElement('div');
                mermaidDiv.className = 'mermaid';
                mermaidDiv.textContent = block.textContent;
                
                // Replace the pre element with the mermaid div
                wrapper.replaceChild(mermaidDiv, pre);
            });
            
            // Initialize Mermaid after conversion
            mermaid.initialize({
                startOnLoad: true,
                theme: 'base',
                themeVariables: {
                    primaryColor: '#2c3e50',
                    primaryTextColor: '#2c3e50',
                    primaryBorderColor: '#34495e',
                    lineColor: '#7f8c8d',
                    secondaryColor: '#ecf0f1',
                    tertiaryColor: '#f8f9fa',
                    background: '#ffffff',
                    mainBkg: '#ffffff',
                    secondBkg: '#f8f9fa',
                    tertiaryBkg: '#ecf0f1'
                },
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true,
                    curve: 'cardinal'
                },
                sequence: {
                    useMaxWidth: true,
                    actorMargin: 50,
                    width: 150,
                    height: 65,
                    boxMargin: 10,
                    boxTextMargin: 5,
                    noteMargin: 10,
                    messageMargin: 35
                },
                gitgraph: {
                    useMaxWidth: true
                }
            });
            
            // Re-render after initialization
            mermaid.init();
        });
    </script>
    
    <!-- JavaScript -->
    <script src="{{ '/assets/js/main.js' | relative_url }}"></script>
    
    <!-- Search data for Lunr.js -->
    <script>
        window.searchData = [
            {% for page in site.pages %}
            {% unless page.url contains '/assets/' %}
            {
                "id": "{{ forloop.index0 }}",
                "title": "{{ page.title | default: page.name | jsonify }}",
                "content": {{ page.content | strip_html | strip_newlines | jsonify }},
                "url": "{{ page.url | relative_url }}"
            }{% unless forloop.last %},{% endunless %}
            {% endunless %}
            {% endfor %}
            {% for doc in site.docs %}
            ,{
                "id": "{{ site.pages.size | plus: forloop.index0 }}",
                "title": {{ doc.title | default: doc.name | jsonify }},
                "content": {{ doc.content | strip_html | strip_newlines | jsonify }},
                "url": "{{ doc.url | relative_url }}"
            }{% unless forloop.last %},{% endunless %}
            {% endfor %}
        ];
    </script>
</body>
</html>